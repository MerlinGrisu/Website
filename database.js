var database = {
	"schueler": [{
		"vname": "Frederik",
		"nname": "Hutfleß",
		"mail": "abc@defg.net"
	}, {
		"vname": "Niklas",
		"nname": "Fanslau",
		"mail": "nik.fanslau@gmail.com"
	}],
	"lehrer": [{
			"vname": "Folke",
			"nname": "Andräs",
			"mail": "andraes@gymnasium-lechenich.de",
			"abk": "xx1",
			"fächer": [
				23
			]
		},
		{
			"vname": "Renate",
			"nname": "Block",
			"mail": "block@gymnasium-lechenich.de",
			"abk": "BLO",
			"fächer": [
				1,
				7,
				14,
				19
			]
		},
		{
			"vname": "Peter",
			"nname": "Bastgen",
			"mail": "bastgen@gymnasium-lechenich.de",
			"abk": "BAS",
			"fächer": [
				0,
				21
			]
		},
		{
			"vname": "Ulrike",
			"nname": "Balters",
			"mail": "balters@gymnasium-lechenich.de",
			"abk": "BAL",
			"fächer": [
				20,
				21
			]
		},
		{
			"vname": "Claudia",
			"nname": "Behrensmeier",
			"mail": "behrensmeier@gymnasium-lechenich.de",
			"abk": "BHR",
			"fächer": [
				23
			]
		},
		{
			"vname": "Nanette",
			"nname": "Berkessel",
			"mail": "berkessel@gymnasium-lechenich.de",
			"abk": "BRK",
			"fächer": [
				0,
				20
			]
		},
		{
			"vname": "Nina",
			"nname": "Böllert",
			"mail": "boellert@gymnasium-lechenich.de",
			"abk": "BOL",
			"fächer": [
				2,
				5
			]
		},
		{
			"vname": "Barbara",
			"nname": "Degen",
			"mail": "degen@gymnasium-lechenich.de",
			"abk": "DGN"
		},
		{
			"vname": "Uta",
			"nname": "Denvir",
			"mail": "denvir@gymnasium-lechenich.de",
			"abk": "DNV"
		},
		{
			"vname": "Nathalie",
			"nname": "Derpa",
			"mail": "derpa@gymnasium-lechenich.de",
			"abk": "DER"
		},
		{
			"vname": "Verena",
			"nname": "Ehrle",
			"mail": "ehrle@gymnasium-lechenich.de",
			"abk": "EHR"
		},
		{
			"vname": "Dorothea",
			"nname": "Ekert",
			"mail": "ekert@gymnasium-lechenich.de",
			"abk": "EKT"
		},
		{
			"vname": "Siegfried",
			"nname": "Fahl",
			"mail": "fahl@gymnasium-lechenich.de",
			"abk": "FAH"
		},
		{
			"vname": "Birgit",
			"nname": "Gerz",
			"mail": "gerz@gymnasium-lechenich.de",
			"abk": "GER"
		},
		{
			"vname": "Sven",
			"nname": "Goslawski",
			"mail": "goslawski@gymnasium-lechenich.de",
			"abk": "GOS"
		},
		{
			"vname": "Ute",
			"nname": "Graf",
			"mail": "graf@gymnasium-lechenich.de",
			"abk": "GRA"
		},
		{
			"vname": "Susanne",
			"nname": "Hobbs",
			"mail": "hobbs@gymnasium-lechenich.de",
			"abk": "HBB"
		},
		{
			"vname": "Anja",
			"nname": "Jünemann",
			"mail": "jünemann@gymnasium-lechenich.de",
			"abk": "JUN"
		},
		{
			"vname": "Anke",
			"nname": "Jurgeleit",
			"mail": "jurgeleit@gymnasium-lechenich.de",
			"abk": "JUR"
		},
		{
			"vname": "Maren",
			"nname": "Kerstiens",
			"mail": "kerstiens@gymnasium-lechenich.de",
			"abk": "KER"
		},
		{
			"vname": "Antje",
			"nname": "Köhr",
			"mail": "koehr@gymnasium-lechenich.de",
			"abk": "xx2"
		},
		{
			"vname": "Doris",
			"nname": "Krampf",
			"mail": "krampf@gymnasium-lechenich.de",
			"abk": "KRA"
		},
		{
			"vname": "Anke",
			"nname": "Kraushaar",
			"mail": "kraushaar@gymnasium-lechenich.de",
			"abk": "KRH"
		},
		{
			"vname": "Nils",
			"nname": "Kuhlmann",
			"mail": "kuhlmann@gymnasium-lechenich.de",
			"abk": "KHL"
		},
		{
			"vname": "Kirsten",
			"nname": "Küstner",
			"mail": "kuestner@gymnasium-lechenich.de",
			"abk": "KST"
		},
		{
			"vname": "Rebecca",
			"nname": "Laebe",
			"mail": "laebe@gymnasium-lechenich.de",
			"abk": "LBE"
		},
		{
			"vname": "Gudrun",
			"nname": "Liedtke",
			"mail": "liedtke@gymnasium-lechenich.de",
			"abk": "LTK"
		},
		{
			"vname": "Achim",
			"nname": "Lingmann",
			"mail": "lingmann@gymnasium-lechenich.de",
			"abk": "LIG"
		},
		{
			"vname": "Eva-Marie",
			"nname": "Dr. Löbbert",
			"mail": "loebbert@gymnasium-lechenich.de",
			"abk": "LBT"
		},
		{
			"vname": "Julia",
			"nname": "Losse",
			"mail": "losse@gymnasium-lechenich.de",
			"abk": "LOS"
		},
		{
			"vname": "Bodo",
			"nname": "Marek",
			"mail": "marek@gymnasium-lechenich.de",
			"abk": "MRK"
		},
		{
			"vname": "Uta",
			"nname": "Meibrink",
			"mail": "meibrink@gymnasium-lechenich.de",
			"abk": "MEI"
		},
		{
			"vname": "Michael",
			"nname": "Meyer",
			"mail": "meyer@gymnasium-lechenich.de",
			"abk": "MYR"
		},
		{
			"vname": "Hanno",
			"nname": "Meyer-Barner",
			"mail": "meyer-barner@gymnasium-lechenich.de",
			"abk": "MEY"
		},
		{
			"vname": "Inga",
			"nname": "Middel",
			"mail": "middel@gymnasium-lechenich.de",
			"abk": "xx3"
		},
		{
			"vname": "Peter",
			"nname": "Neugaertner",
			"mail": "neugaertner@gymnasium-lechenich.de",
			"abk": "NGT"
		},
		{
			"vname": "Florens",
			"nname": "Neuheuser",
			"mail": "neuheuser@gymnasium-lechenich.de",
			"abk": "NEU"
		},
		{
			"vname": "Isabel",
			"nname": "Núñez",
			"mail": "nunez@gymnasium-lechenich.de",
			"abk": "NNE"
		},
		{
			"vname": "Volker",
			"nname": "Priwitzer",
			"mail": "priwitzer@gymnasium-lechenich.de",
			"abk": "PRI"
		},
		{
			"vname": "Yvonne",
			"nname": "Rogoll",
			"mail": "rogoll@gymnasium-lechenich.de",
			"abk": "RGL"
		},
		{
			"vname": "Sabiene",
			"nname": "Rosenau",
			"mail": "rosenau@gymnasium-lechenich.de",
			"abk": "RSN"
		},
		{
			"vname": "Eva",
			"nname": "Roth",
			"mail": "roth@gymnasium-lechenich.de",
			"abk": "ROT"
		},
		{
			"vname": "Christoph",
			"nname": "Rumsmüller",
			"mail": "rumsmueller@gymnasium-lechenich.de",
			"abk": "RML"
		},
		{
			"vname": "Jochen",
			"nname": "Schindler",
			"mail": "schindler@gymnasium-lechenich.de",
			"abk": "SDL"
		},
		{
			"vname": "Kristina",
			"nname": "Schmalenbach",
			"mail": "schmalenbach@gymnasium-lechenich.de",
			"abk": "SMB"
		},
		{
			"vname": "Irmgard",
			"nname": "Schmitz",
			"mail": "schmitz@gymnasium-lechenich.de",
			"abk": "SMT"
		},
		{
			"vname": "Kathryn",
			"nname": "Schulte",
			"mail": "schulte@gymnasium-lechenich.de",
			"abk": "SLT"
		}
	],
	"fächer": [{ //0
			"abk": "M",
			"name": "Mathematik"
		},
		{
			"abk": "D",
			"name": "Deutsch"
		},
		{
			"abk": "E5",
			"name": "Englisch ab 5"
		},
		{
			"abk": "F6",
			"name": "Französisch ab 6"
		},
		{
			"abk": "F9",
			"name": "Französisch ab 9"
		},
		{ //5
			"abk": "S",
			"name": "Spanisch"
		},
		{
			"abk": "L",
			"name": "Latein"
		},
		{
			"abk": "Ku",
			"name": "Kunst"
		},
		{
			"abk": "Mu",
			"name": "Musik"
		},
		{
			"abk": "Ge",
			"name": "Geschichte"
		},
		{ //10
			"abk": "Pl",
			"name": "Politik"
		},
		{
			"abk": "ZKG",
			"name": "Zusatzkurs Geschichte"
		},
		{
			"abk": "Erdkunde",
			"name": "Ek"
		},
		{
			"abk": "Pp",
			"name": "Philosophie"
		},
		{
			"abk": "Ew",
			"name": "Erziehungswissenschaften"
		},
		{ //15
			"abk": "Sw",
			"name": "Sozialwissenschaften"
		},
		{
			"abk": "ZKS",
			"name": "Zusatzkurs Sozialwissenschaften"
		},
		{
			"abk": "Kr",
			"name": "Katholische Religion"
		},
		{
			"abk": "Er",
			"name": "Evangelische Religion"
		},
		{
			"abk": "Bi",
			"name": "Biologie"
		},
		{ //20
			"abk": "Ch",
			"name": "Chemie"
		},
		{
			"abk": "Ph",
			"name": "Physik"
		},
		{
			"abk": "If",
			"name": "Informatik"
		},
		{
			"abk": "Sp",
			"name": "Sport"
		},
		{
			"abk": "VTE",
			"name": "Vertiefungsfach Englisch"
		},
		{
			"abk": "VTM",
			"name": "Vertiefungsfach Mathematik"
		},
		{
			"abk": "xx",
			"name": "Projektkurs Sprachen"
		},
		{
			"abk": "x1",
			"name": "Projektkurs NW"
		},
		{
			"abk": "Ele",
			"name": "Elektronik"
		}
	],
	"kurse": [{
			"FachID": 0,
			"LehrerID": 1,
			"GK": true,
			"Nummer": 2
		},
		{
			"FachID": 1,
			"LehrerID": 2,
			"GK": false,
			"Nummer": 5
		},
		{
			"FachID": 2,
			"LehrerID": 4,
			"GK": true,
			"Nummer": 1
		}
	],
	"blöcke": [{
			"AWoche": true,
			"Wochentag": 1,
			"Block": 1
		},
		{
			"AWoche": true,
			"Wochentag": 1,
			"Block": 2
		},
		{
			"AWoche": true,
			"Wochentag": 1,
			"Block": 3
		},
		{
			"AWoche": true,
			"Wochentag": 1,
			"Block": 4
		},
		{
			"AWoche": true,
			"Wochentag": 1,
			"Block": 5
		}
	],
	"räume": [{
			"trakt": "A",
			"nummer": "104"
		},
		{
			"trakt": "D",
			"nummer": "009"
		},
		{
			"trakt": "A",
			"nummer": "3"
		}
	],
	"kursblöcke": [{
			"KursID": 0,
			"BlockID": 2,
			"RaumID": 1
		},
		{
			"KursID": 0,
			"BlockID": 3,
			"RaumID": 2
		},
		{
			"KursID": 1,
			"BlockID": 2,
			"RaumID": 0
		},
		{
			"KursID": 2,
			"BlockID": 4,
			"RaumID": 2
		}
	],
	"schuelerkurse": [{
			"SchuelerID": 0,
			"KursID": 0
		},
		{
			"SchuelerID": 0,
			"KursID": 1
		},
		{
			"SchuelerID": 1,
			"KursID": 0
		},
		{
			"SchuelerID": 1,
			"KursID": 2
		}
	],
	"vertretung": [{
			"KursID": 0,
			"RaumID": 1,
			"LehrerID": 18
		},
		{
			"KursID": 2,
			"RaumID": 0,
			"LehrerID": 19
		},
		{
			"KursID": 1,
			"RaumID": 1,
			"LehrerID": 21
		}
	],
	"aufgaben": [{
		"VertretungID": 0,
		"URL": "bastgen.de/schule/physik/11/Material/Stoss.pdf",
		"data-type": "image/jpg"
	}],
	"rollen": [{
			"name": "schueler"
		},
		{
			"name": "lehrer"
		},
		{
			"name": "admin"
		}
	],
	"nutzer": [{
			"isSchueler": true,
			"SLID": 0,
			"password": "freds passwort",
			"RollenID": 2
		},
		{
			"isSchueler": true,
			"SLID": 1,
			"password": "niks passwort",
			"RollenID": 0
		}
	],
	"fachfach": [{
		"FachID1": 0,
		"FachID2": 1,
		"distance": 4
	}],
	"fehlendeklassen": [{
		"klassen": "9a, 9c",
		"grund": "Skifreizeit"
	}]
};
const NID = 0; //Nutzer 1 ist eingeloggt

var fehlendeLehrer = [],
	vertretendeLehrer = [];


function get(db_name) {
	return database[db_name];
}

function get_aufgaben(vid) {
	var i, results = [];
	for (i = 0; i < get("aufgaben").length; ++i)
		if (get("aufgaben")[i].VertretungID == vid)
			results.push(get("aufgaben")[i].URL);
	return results;
}

function get_vertretung() {
	write_date();
	get_fehlende_klassen();
	var i, d = get("vertretung"),
		html = "<div style='clear:both;height:0px;'>&nbsp;</div>";
	for (i = 0; i < d.length; ++i) {
		fehlendeLehrer.push(get("kurse")[d[i].KursID].LehrerID);
		vertretendeLehrer.push(d[i].LehrerID);
		html += "<div class='vertretung'><b>" + get("lehrer")[get("kurse")[d[i].KursID].LehrerID].abk +
			" - " + get("lehrer")[d[i].LehrerID].abk +
			"</b><br/>" + (get("kurse")[d[i].KursID].GK ? "GK" : "LK") + get("kurse")[d[i].KursID].Nummer +
			", " + get("fächer")[get("kurse")[d[i].KursID].FachID].name +
			", " + (get("räume")[d[i].RaumID].trakt + get("räume")[d[i].RaumID].nummer) +
			"<br/>" + (get_aufgaben(i).length > 0 ? "<a href='http://" + get_aufgaben(i)[0] + "' target='_BLANK'>Aufgaben</a>" : "") +
			"</div>";
	}
	document.getElementById("vertretung").innerHTML += html;
}

function get_fehlende_klassen() {
	var i, html = "";
	for (i = 0; i < get("fehlendeklassen").length; ++i) {
		html += "<div class='vertretung-small'>Fehlende Klassen:<br/>" + get("fehlendeklassen")[i].klassen +
			"<br/>wegen " + get("fehlendeklassen")[i].grund +
			"</div>"
	}
	document.getElementById("vertretung").innerHTML += html;
}

function write_date() {
	document.getElementById("vertretung").innerHTML = "<div class='vertretung-small'><b>A-Woche</b><br/>Montag, 20.Feb.2017</div>";
}

function get_fehlende_lehrer() {
	var i, a = [],
		html = "Fehlende Lehrer: ";
	for (i = 0; i < fehlendeLehrer.length; ++i) {
		a.push(get("lehrer")[fehlendeLehrer[i]].abk);
	}
	html += a.join(" - ");
	document.getElementById("fehlendeLehrer").innerHTML = html;
}

function get_vertretende_lehrer() {
	var i, a = [],
		html = "Vertretende Lehrer: ";
	for (i = 0; i < vertretendeLehrer.length; ++i) {
		a.push(get("lehrer")[vertretendeLehrer[i]].abk);
	}
	html += a.join(" - ");
	document.getElementById("vertretendeLehrer").innerHTML = html;
}

function get_nutzerdaten() {
	//Nur für Schüler
	var html = `
		Name: ${get("schueler")[get("nutzer")[NID].SLID].vname} ${get("schueler")[get("nutzer")[NID].SLID].nname}<br/>
		Mail: ${get("schueler")[get("nutzer")[NID].SLID].mail}<br/>
		Passwort: ${get("nutzer")[NID].password}<br/><br/>Belegte Kurse:<br/><ol>
	`,
		i, j, kurse = [];
	for (i = 0; i < get("schuelerkurse").length; ++i) {
		if (get("schuelerkurse")[i].SchuelerID == NID) {
			kurse.push(get("schuelerkurse")[i].KursID);
		}
	}
	for (i = 0; i < kurse.length; ++i) {
		html += "<li>" + (get("kurse")[kurse[i]].GK ? "GK" : "LK") + get("kurse")[kurse[i]].Nummer +
			" " + get("fächer")[get("kurse")[kurse[i]].FachID].name +
			", bei " + get("lehrer")[get("kurse")[kurse[i]].LehrerID].abk + "</li>";
		for (j = 0; j < get("kursblöcke").length; ++j) {
			if (get("kursblöcke")[j].KursID == kurse[i]) {
				html += (get("blöcke")[get("kursblöcke")[j].BlockID].AWoche ? "A" : "B") +
					"-Woche " + ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"][get("blöcke")[get("kursblöcke")[j].BlockID].Wochentag] +
					", " + get("blöcke")[get("kursblöcke")[j].BlockID].Block + ". Block<br/>";
			}
		}
	}
	html += "</ol>"
	document.getElementById("w").innerHTML += html;
}
